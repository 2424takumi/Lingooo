# Lingooo ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æ©Ÿèƒ½å®Ÿè£…ãƒ—ãƒ©ãƒ³

**ä½œæˆæ—¥**: 2025-01-18
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: å®Ÿè£…å¾…ã¡
**æ¨å®šå·¥æ•°**: 4é€±é–“ï¼ˆ1äººãƒ•ãƒ«ã‚¿ã‚¤ãƒ ï¼‰
**æŠ€è¡“ãƒªã‚¹ã‚¯**: ä½

---

## ğŸ“‹ ç›®æ¬¡

1. [ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³æ©Ÿèƒ½å®šç¾©](#ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³æ©Ÿèƒ½å®šç¾©)
2. [å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—](#å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—)
3. [æŠ€è¡“é¸å®š](#æŠ€è¡“é¸å®š)
4. [ã‚³ã‚¹ãƒˆãƒ»åç›Šåˆ†æ](#ã‚³ã‚¹ãƒˆåç›Šåˆ†æ)
5. [æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§](#æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§)
6. [å®Œæˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](#å®Œæˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ)

---

## ğŸ’ ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³æ©Ÿèƒ½å®šç¾©

### **Lingooo Premiumï¼ˆæœˆé¡500å††ï¼‰**

| æ©Ÿèƒ½ | ç„¡æ–™ç‰ˆ | ãƒ—ãƒ¬ãƒŸã‚¢ãƒ  | å®Ÿè£…çŠ¶æ³ |
|------|--------|-----------|---------|
| **AIè³ªå•å›æ•°** | æœˆ100å› | æœˆ1,000å› | âœ… å®Ÿè£…æ¸ˆã¿ï¼ˆåˆ¶é™å¼·åŒ–ã®ã¿ï¼‰ |
| **ç¿»è¨³æ–‡å­—æ•°** | 4,000æ–‡å­—/å› | 50,000æ–‡å­—/å› | âŒ æœªå®Ÿè£… |
| **ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ•ã‚©ãƒ«ãƒ€** | âŒ åˆ©ç”¨ä¸å¯ | âœ… ç„¡åˆ¶é™ | âœ… å®Ÿè£…æ¸ˆã¿ï¼ˆåˆ¶é™è¿½åŠ ï¼‰ |
| **å­¦ç¿’è¨€èªç™»éŒ²** | 3è¨€èªã¾ã§ | ç„¡åˆ¶é™ | âŒ æœªå®Ÿè£… |
| **AIå¿œç­”è©³ç´°åº¦** | ç°¡æ½”ã®ã¿ | ç°¡æ½”ãƒ»è©³ç´°é¸æŠå¯ | âœ… å®Ÿè£…æ¸ˆã¿ï¼ˆåˆ¶é™è¿½åŠ ï¼‰ |
| **ä½¿ç”¨AIãƒ¢ãƒ‡ãƒ«** | Gemini Flash | Gemini Flash | âœ… å®Ÿè£…ä¸è¦ |

### ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã®ä¾¡å€¤ææ¡ˆ

**ã‚­ãƒ£ãƒƒãƒã‚³ãƒ”ãƒ¼:**
ã€Œåˆ¶é™ãªãã€å¥½ããªã ã‘è¨€è‘‰ã‚’æ¢ç©¶ã§ãã‚‹AIè¾æ›¸ã€

**ä¸»ãªè¨´æ±‚ãƒã‚¤ãƒ³ãƒˆ:**
1. **10å€ã®è³ªå•å›æ•°** - æœˆ100å› â†’ 1,000å›
2. **12.5å€ã®ç¿»è¨³å®¹é‡** - 4,000æ–‡å­— â†’ 50,000æ–‡å­—
3. **æ•´ç†æ©Ÿèƒ½** - ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’ãƒ•ã‚©ãƒ«ãƒ€ã§åˆ†é¡
4. **å¤šè¨€èªå¯¾å¿œ** - 3è¨€èª â†’ ç„¡åˆ¶é™
5. **è©³ç´°ãªAIå›ç­”** - èªæºãƒ»èƒŒæ™¯ã¾ã§æ·±æ˜ã‚Š

---

## ğŸ› ï¸ å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ï¼ˆ4é€±é–“ï¼‰

### **Week 1: ã‚µãƒ–ã‚¹ã‚¯åŸºç›¤æ§‹ç¯‰**

#### Day 1-2: RevenueCat ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**ã‚¿ã‚¹ã‚¯:**
- [ ] RevenueCat ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
- [ ] App Store Connect ã§ IAP å•†å“ç™»éŒ²
  - å•†å“ID: `com.lingooo.premium.monthly`
  - ä¾¡æ ¼: Â¥500/æœˆ
  - 7æ—¥é–“ç„¡æ–™ãƒˆãƒ©ã‚¤ã‚¢ãƒ«è¨­å®š
- [ ] Google Play Console ã§å•†å“ç™»éŒ²
- [ ] SDK ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«: `npx expo install react-native-purchases`
- [ ] ç’°å¢ƒå¤‰æ•°è¿½åŠ ï¼ˆ`.env`, `eas.json`ï¼‰
  - `EXPO_PUBLIC_REVENUECAT_API_KEY_IOS`
  - `EXPO_PUBLIC_REVENUECAT_API_KEY_ANDROID`

**æˆæœç‰©:**
- RevenueCat ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¨­å®šå®Œäº†
- IAPå•†å“IDå–å¾—å®Œäº†

---

#### Day 3: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ‹¡å¼µ

**æ–°è¦ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³:**
`lingooo-mobile/supabase/migrations/002_add_subscription_fields.sql`

```sql
-- ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³é–¢é€£ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ 
ALTER TABLE users
ADD COLUMN IF NOT EXISTS subscription_status VARCHAR(20) DEFAULT 'inactive',
ADD COLUMN IF NOT EXISTS subscription_expires_at TIMESTAMP,
ADD COLUMN IF NOT EXISTS revenuecat_customer_id VARCHAR(255),
ADD COLUMN IF NOT EXISTS trial_ends_at TIMESTAMP,
ADD COLUMN IF NOT EXISTS subscription_platform VARCHAR(20);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¿½åŠ 
CREATE INDEX IF NOT EXISTS idx_users_subscription_status
ON users(subscription_status);

CREATE INDEX IF NOT EXISTS idx_users_subscription_expires
ON users(subscription_expires_at);

-- ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°é–¢æ•°
CREATE OR REPLACE FUNCTION update_subscription_status(
  user_id UUID,
  status VARCHAR(20),
  expires_at TIMESTAMP,
  customer_id VARCHAR(255),
  platform VARCHAR(20)
)
RETURNS VOID
LANGUAGE plpgsql
AS $$
BEGIN
  UPDATE users
  SET
    subscription_status = status,
    subscription_expires_at = expires_at,
    revenuecat_customer_id = customer_id,
    subscription_platform = platform,
    plan = CASE
      WHEN status = 'active' THEN 'plus'
      ELSE 'free'
    END
  WHERE id = user_id;
END;
$$;

GRANT EXECUTE ON FUNCTION update_subscription_status TO authenticated;

COMMENT ON FUNCTION update_subscription_status IS
'Update user subscription status from RevenueCat webhook';
```

**æˆæœç‰©:**
- Supabase ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨å®Œäº†

---

#### Day 4-5: Subscription Context å®Ÿè£…

**æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-mobile/contexts/subscription-context.tsx`

```typescript
import { createContext, useContext, useState, useEffect, ReactNode } from 'react';
import Purchases, {
  PurchasesPackage,
  CustomerInfo,
  PurchasesOfferings
} from 'react-native-purchases';
import { Platform } from 'react-native';
import { useAuth } from './auth-context';
import { supabase } from '@/lib/supabase';
import { logger } from '@/utils/logger';

interface SubscriptionContextType {
  isPremium: boolean;
  isLoading: boolean;
  packages: PurchasesPackage[];
  purchasePackage: (pkg: PurchasesPackage) => Promise<void>;
  restorePurchases: () => Promise<void>;
  expiryDate: Date | null;
  customerInfo: CustomerInfo | null;
}

const SubscriptionContext = createContext<SubscriptionContextType | undefined>(undefined);

export function useSubscription() {
  const context = useContext(SubscriptionContext);
  if (!context) {
    throw new Error('useSubscription must be used within a SubscriptionProvider');
  }
  return context;
}

interface SubscriptionProviderProps {
  children: ReactNode;
}

export function SubscriptionProvider({ children }: SubscriptionProviderProps) {
  const { user } = useAuth();
  const [isPremium, setIsPremium] = useState(false);
  const [isLoading, setIsLoading] = useState(true);
  const [packages, setPackages] = useState<PurchasesPackage[]>([]);
  const [customerInfo, setCustomerInfo] = useState<CustomerInfo | null>(null);
  const [expiryDate, setExpiryDate] = useState<Date | null>(null);

  useEffect(() => {
    if (user) {
      initializePurchases();
    }
  }, [user]);

  const initializePurchases = async () => {
    if (!user) return;

    try {
      // RevenueCatåˆæœŸåŒ–
      await Purchases.configure({
        apiKey: Platform.select({
          ios: process.env.EXPO_PUBLIC_REVENUECAT_API_KEY_IOS!,
          android: process.env.EXPO_PUBLIC_REVENUECAT_API_KEY_ANDROID!,
        })!,
        appUserID: user.id,
      });

      logger.info('[Subscription] RevenueCat configured for user:', user.id);

      // ã‚ªãƒ•ã‚¡ãƒªãƒ³ã‚°å–å¾—
      const offerings: PurchasesOfferings = await Purchases.getOfferings();
      if (offerings.current) {
        setPackages(offerings.current.availablePackages);
        logger.info('[Subscription] Available packages:', offerings.current.availablePackages.length);
      }

      // ã‚µãƒ–ã‚¹ã‚¯çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯
      await checkSubscriptionStatus();
    } catch (error) {
      logger.error('[Subscription] Failed to initialize:', error);
    } finally {
      setIsLoading(false);
    }
  };

  const checkSubscriptionStatus = async () => {
    try {
      const info: CustomerInfo = await Purchases.getCustomerInfo();
      setCustomerInfo(info);

      // ãƒ—ãƒ¬ãƒŸã‚¢ãƒ  entitlement ãƒã‚§ãƒƒã‚¯
      const premiumEntitlement = info.entitlements.active['premium'];
      const isActive = premiumEntitlement !== undefined;

      setIsPremium(isActive);

      if (isActive && premiumEntitlement.expirationDate) {
        const expiry = new Date(premiumEntitlement.expirationDate);
        setExpiryDate(expiry);
        logger.info('[Subscription] Premium active until:', expiry);

        // Supabaseã¨åŒæœŸ
        await syncToSupabase('active', expiry, info.originalAppUserId, Platform.OS);
      } else {
        setExpiryDate(null);
        await syncToSupabase('inactive', null, info.originalAppUserId, Platform.OS);
      }
    } catch (error) {
      logger.error('[Subscription] Failed to check status:', error);
    }
  };

  const syncToSupabase = async (
    status: string,
    expiresAt: Date | null,
    customerId: string,
    platform: string
  ) => {
    try {
      const { error } = await supabase.rpc('update_subscription_status', {
        user_id: user?.id,
        status,
        expires_at: expiresAt?.toISOString(),
        customer_id: customerId,
        platform,
      });

      if (error) {
        logger.error('[Subscription] Failed to sync to Supabase:', error);
      } else {
        logger.info('[Subscription] Synced to Supabase:', status);
      }
    } catch (error) {
      logger.error('[Subscription] Sync error:', error);
    }
  };

  const purchasePackage = async (pkg: PurchasesPackage) => {
    try {
      logger.info('[Subscription] Starting purchase:', pkg.identifier);
      const { customerInfo: info } = await Purchases.purchasePackage(pkg);
      setCustomerInfo(info);
      await checkSubscriptionStatus();
      logger.info('[Subscription] Purchase successful');
    } catch (error: any) {
      if (!error.userCancelled) {
        logger.error('[Subscription] Purchase failed:', error);
        throw error;
      }
      logger.info('[Subscription] Purchase cancelled by user');
    }
  };

  const restorePurchases = async () => {
    try {
      logger.info('[Subscription] Restoring purchases');
      const info: CustomerInfo = await Purchases.restorePurchases();
      setCustomerInfo(info);
      await checkSubscriptionStatus();
      logger.info('[Subscription] Restore successful');
    } catch (error) {
      logger.error('[Subscription] Restore failed:', error);
      throw error;
    }
  };

  const value: SubscriptionContextType = {
    isPremium,
    isLoading,
    packages,
    purchasePackage,
    restorePurchases,
    expiryDate,
    customerInfo,
  };

  return (
    <SubscriptionContext.Provider value={value}>
      {children}
    </SubscriptionContext.Provider>
  );
}
```

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-mobile/app/_layout.tsx` - SubscriptionProviderã‚’è¿½åŠ 

```typescript
import { SubscriptionProvider } from '@/contexts/subscription-context';

export default function RootLayout() {
  return (
    <AuthProvider>
      <SubscriptionProvider>
        {/* æ—¢å­˜ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
      </SubscriptionProvider>
    </AuthProvider>
  );
}
```

**æˆæœç‰©:**
- ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³çŠ¶æ…‹ç®¡ç†å®Œäº†
- RevenueCat SDKçµ±åˆå®Œäº†

---

### **Week 2: ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½åˆ¶é™å®Ÿè£…**

#### Day 6-7: ç¿»è¨³æ–‡å­—æ•°åˆ¶é™

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-mobile/constants/validation.ts`

```typescript
// ãƒ—ãƒ©ãƒ³åˆ¥ã®æ–‡å­—æ•°åˆ¶é™
export const MAX_TEXT_LENGTH_FREE = 4000;
export const MAX_TEXT_LENGTH_PREMIUM = 50000;

export function getMaxTextLength(isPremium: boolean): number {
  return isPremium ? MAX_TEXT_LENGTH_PREMIUM : MAX_TEXT_LENGTH_FREE;
}
```

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-mobile/app/(tabs)/translate.tsx` (ç¿»è¨³ç”»é¢)

```typescript
import { useSubscription } from '@/contexts/subscription-context';
import { getMaxTextLength } from '@/constants/validation';

export default function TranslateScreen() {
  const { isPremium } = useSubscription();
  const maxLength = getMaxTextLength(isPremium);

  const handleTranslate = async () => {
    if (inputText.length > maxLength) {
      Alert.alert(
        'æ–‡å­—æ•°åˆ¶é™',
        `ç¿»è¨³ã¯${maxLength.toLocaleString()}æ–‡å­—ä»¥å†…ã«ã—ã¦ãã ã•ã„ã€‚\n\n${
          !isPremium ? 'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ãªã‚‰50,000æ–‡å­—ã¾ã§ç¿»è¨³ã§ãã¾ã™ã€‚' : ''
        }`,
        [
          { text: 'OK' },
          ...(!isPremium ? [{ text: 'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚’è¦‹ã‚‹', onPress: () => router.push('/subscription') }] : []),
        ]
      );
      return;
    }
    // ... ç¿»è¨³å‡¦ç†
  };

  return (
    <View>
      <TextInput
        value={inputText}
        onChangeText={setInputText}
        maxLength={maxLength}
      />
      <Text style={styles.charCount}>
        {inputText.length.toLocaleString()} / {maxLength.toLocaleString()}æ–‡å­—
        {!isPremium && ' (ç„¡æ–™ç‰ˆ)'}
      </Text>
    </View>
  );
}
```

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å¤‰æ›´:**
`lingooo-backend/src/routes/translate.ts`

```typescript
router.post('/translate', authenticate, enforceQuota, async (req, res) => {
  const { text } = req.body;
  const user = req.user;

  // ãƒ—ãƒ©ãƒ³åˆ¤å®š
  const isPremium =
    user.plan === 'plus' &&
    user.subscription_status === 'active' &&
    new Date(user.subscription_expires_at) > new Date();

  const maxLength = isPremium ? 50000 : 4000;

  if (text.length > maxLength) {
    return res.status(400).json({
      error: 'Text too long',
      message: `ãƒ†ã‚­ã‚¹ãƒˆã¯${maxLength.toLocaleString()}æ–‡å­—ä»¥å†…ã«ã—ã¦ãã ã•ã„`,
      isPremium,
      maxLength,
    });
  }

  // ... ç¿»è¨³å‡¦ç†
});
```

**æˆæœç‰©:**
- ç¿»è¨³æ–‡å­—æ•°åˆ¶é™å®Ÿè£…å®Œäº†

---

#### Day 8-9: å­¦ç¿’è¨€èª3è¨€èªåˆ¶é™

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-mobile/contexts/learning-languages-context.tsx`

```typescript
import { useSubscription } from './subscription-context';
import { router } from 'expo-router';

const MAX_LANGUAGES_FREE = 3;

export function LearningLanguagesProvider({ children }: LearningLanguagesProviderProps) {
  const { isPremium } = useSubscription();

  const addLearningLanguage = async (languageId: string) => {
    if (!user) return;

    // ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã§ãªã„å ´åˆã¯3è¨€èªåˆ¶é™
    if (!isPremium && learningLanguages.length >= MAX_LANGUAGES_FREE) {
      Alert.alert(
        'å­¦ç¿’è¨€èªã®ä¸Šé™',
        `ç„¡æ–™ç‰ˆã§ã¯${MAX_LANGUAGES_FREE}è¨€èªã¾ã§ç™»éŒ²ã§ãã¾ã™ã€‚\n\nãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ãªã‚‰ç„¡åˆ¶é™ã«ç™»éŒ²ã§ãã¾ã™ã€‚`,
        [
          { text: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«' },
          { text: 'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚’è¦‹ã‚‹', onPress: () => router.push('/subscription') },
        ]
      );
      return;
    }

    // ... æ—¢å­˜ã®è¿½åŠ ãƒ­ã‚¸ãƒƒã‚¯
  };

  return (
    <LearningLanguagesContext.Provider value={{ ... }}>
      {children}
    </LearningLanguagesContext.Provider>
  );
}
```

**æˆæœç‰©:**
- å­¦ç¿’è¨€èª3è¨€èªåˆ¶é™å®Œäº†

---

#### Day 10-11: ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ åŒ–

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-mobile/app/(tabs)/bookmarks.tsx`

```typescript
import { useSubscription } from '@/contexts/subscription-context';

export default function BookmarksScreen() {
  const { isPremium } = useSubscription();

  const handleCreateFolder = () => {
    if (!isPremium) {
      Alert.alert(
        'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½',
        'ãƒ•ã‚©ãƒ«ãƒ€æ©Ÿèƒ½ã¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é™å®šã§ã™ã€‚\n\nãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’æ•´ç†ã—ã¦ã‚ˆã‚ŠåŠ¹ç‡çš„ã«å­¦ç¿’ã—ã¾ã—ã‚‡ã†ã€‚',
        [
          { text: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«' },
          { text: 'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚’è¦‹ã‚‹', onPress: () => router.push('/subscription') },
        ]
      );
      return;
    }
    setIsCreateFolderModalOpen(true);
  };

  return (
    <View>
      {/* ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ */}
      <View style={styles.tabContainer}>
        <TouchableOpacity onPress={() => setActiveTab('all')}>
          <Text>ã™ã¹ã¦</Text>
        </TouchableOpacity>
        <TouchableOpacity
          onPress={() => {
            if (!isPremium) {
              Alert.alert(
                'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½',
                'ãƒ•ã‚©ãƒ«ãƒ€æ©Ÿèƒ½ã¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é™å®šã§ã™ã€‚',
                [
                  { text: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«' },
                  { text: 'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚’è¦‹ã‚‹', onPress: () => router.push('/subscription') },
                ]
              );
              return;
            }
            setActiveTab('folders');
          }}
        >
          <View style={styles.tabItem}>
            <Text>ãƒ•ã‚©ãƒ«ãƒ€</Text>
            {!isPremium && <LockIcon size={16} color="#686868" />}
          </View>
        </TouchableOpacity>
      </View>
    </View>
  );
}
```

**æˆæœç‰©:**
- ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ åˆ¶é™å®Œäº†

---

#### Day 12: AIè©³ç´°åº¦ã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ å°‚ç”¨åŒ–

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-mobile/app/(tabs)/settings.tsx`

```typescript
import { useSubscription } from '@/contexts/subscription-context';

export default function SettingsScreen() {
  const { isPremium } = useSubscription();
  const { aiDetailLevel, setAIDetailLevel } = useAISettings();

  return (
    <View style={styles.settingItem}>
      <View style={styles.settingInfo}>
        <View style={styles.labelRow}>
          <Text style={styles.settingLabel}>AIè¿”ç­”ã®è©³ç´°åº¦</Text>
          {!isPremium && <LockIcon size={16} color="#686868" />}
        </View>
        <Text style={styles.settingDescription}>
          {aiDetailLevel === 'concise' ? 'ç°¡æ½”ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰' : 'è©³ç´°ï¼ˆèªæºãƒ»è¿½åŠ ä¾‹æ–‡å«ã‚€ï¼‰'}
        </Text>
      </View>
      <Switch
        value={aiDetailLevel === 'detailed'}
        onValueChange={(value) => {
          if (value && !isPremium) {
            Alert.alert(
              'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½',
              'è©³ç´°ãªAIå¿œç­”ã¯ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é™å®šã§ã™ã€‚\n\nèªæºã€ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã€æ–‡åŒ–çš„èƒŒæ™¯ã¾ã§æ·±ãå­¦ã¹ã¾ã™ã€‚',
              [
                { text: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«' },
                { text: 'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚’è¦‹ã‚‹', onPress: () => router.push('/subscription') },
              ]
            );
            return;
          }
          setAIDetailLevel(value ? 'detailed' : 'concise');
        }}
        disabled={!isPremium && aiDetailLevel === 'concise'}
        trackColor={{ false: '#D1D1D1', true: '#111111' }}
        thumbColor="#FFFFFF"
      />
    </View>
  );
}
```

**æˆæœç‰©:**
- AIè©³ç´°åº¦åˆ¶é™å®Œäº†

---

### **Week 3: UI/UXå®Ÿè£…**

#### Day 13-15: ãƒšã‚¤ã‚¦ã‚©ãƒ¼ãƒ«UI

**æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-mobile/components/paywall/premium-paywall.tsx`

```typescript
import { Modal, ScrollView, View, Text, TouchableOpacity, StyleSheet } from 'react-native';
import { useSubscription } from '@/contexts/subscription-context';
import { router } from 'expo-router';

interface PremiumPaywallProps {
  visible: boolean;
  onClose: () => void;
  feature?: string;
}

export function PremiumPaywall({ visible, onClose, feature }: PremiumPaywallProps) {
  const { packages, purchasePackage, isLoading } = useSubscription();

  const handlePurchase = async () => {
    if (packages.length === 0) return;

    try {
      await purchasePackage(packages[0]);
      onClose();
    } catch (error) {
      console.error('Purchase failed:', error);
    }
  };

  const monthlyPackage = packages.find((pkg) => pkg.packageType === 'MONTHLY');
  const price = monthlyPackage?.product.priceString || 'Â¥500';

  return (
    <Modal visible={visible} animationType="slide" presentationStyle="pageSheet">
      <ScrollView style={styles.container}>
        {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
        <View style={styles.header}>
          <TouchableOpacity onPress={onClose} style={styles.closeButton}>
            <Text style={styles.closeText}>Ã—</Text>
          </TouchableOpacity>
        </View>

        {/* ã‚¿ã‚¤ãƒˆãƒ« */}
        <View style={styles.titleContainer}>
          <Text style={styles.title}>Lingooo Premium</Text>
          <Text style={styles.subtitle}>åˆ¶é™ãªãã€å¥½ããªã ã‘è¨€è‘‰ã‚’æ¢ç©¶</Text>
        </View>

        {/* æ©Ÿèƒ½æ¯”è¼ƒ */}
        <View style={styles.featuresContainer}>
          <FeatureItem
            title="AIè³ªå•å›æ•°"
            free="æœˆ100å›ã¾ã§"
            premium="æœˆ1,000å›ã¾ã§"
            highlight
          />
          <FeatureItem
            title="ç¿»è¨³æ–‡å­—æ•°"
            free="4,000æ–‡å­—/å›"
            premium="50,000æ–‡å­—/å›"
          />
          <FeatureItem
            title="ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ•ã‚©ãƒ«ãƒ€"
            free="åˆ©ç”¨ä¸å¯"
            premium="ç„¡åˆ¶é™"
          />
          <FeatureItem
            title="å­¦ç¿’è¨€èªç™»éŒ²"
            free="3è¨€èªã¾ã§"
            premium="ç„¡åˆ¶é™"
          />
          <FeatureItem
            title="AIå¿œç­”è©³ç´°åº¦"
            free="ç°¡æ½”ã®ã¿"
            premium="ç°¡æ½”ãƒ»è©³ç´°"
          />
        </View>

        {/* ä¾¡æ ¼ */}
        <View style={styles.priceContainer}>
          <Text style={styles.priceLabel}>æœˆé¡</Text>
          <Text style={styles.price}>{price}</Text>
          <Text style={styles.trial}>7æ—¥é–“ç„¡æ–™ãƒˆãƒ©ã‚¤ã‚¢ãƒ«</Text>
        </View>

        {/* è³¼å…¥ãƒœã‚¿ãƒ³ */}
        <TouchableOpacity
          style={styles.purchaseButton}
          onPress={handlePurchase}
          disabled={isLoading}
        >
          <Text style={styles.purchaseButtonText}>
            {isLoading ? 'å‡¦ç†ä¸­...' : 'ç„¡æ–™ãƒˆãƒ©ã‚¤ã‚¢ãƒ«ã‚’é–‹å§‹'}
          </Text>
        </TouchableOpacity>

        {/* æ³¨æ„äº‹é … */}
        <Text style={styles.disclaimer}>
          7æ—¥é–“ã®ç„¡æ–™ãƒˆãƒ©ã‚¤ã‚¢ãƒ«å¾Œã€è‡ªå‹•çš„ã«{price}/æœˆã§æ›´æ–°ã•ã‚Œã¾ã™ã€‚
          ã„ã¤ã§ã‚‚ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½ã§ã™ã€‚
        </Text>

        {/* ãƒªãƒ³ã‚¯ */}
        <View style={styles.linksContainer}>
          <TouchableOpacity onPress={() => {}}>
            <Text style={styles.link}>åˆ©ç”¨è¦ç´„</Text>
          </TouchableOpacity>
          <Text style={styles.linkSeparator}>ãƒ»</Text>
          <TouchableOpacity onPress={() => {}}>
            <Text style={styles.link}>ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</Text>
          </TouchableOpacity>
        </View>
      </ScrollView>
    </Modal>
  );
}

interface FeatureItemProps {
  title: string;
  free: string;
  premium: string;
  highlight?: boolean;
}

function FeatureItem({ title, free, premium, highlight }: FeatureItemProps) {
  return (
    <View style={[styles.featureItem, highlight && styles.featureItemHighlight]}>
      <Text style={styles.featureTitle}>{title}</Text>
      <View style={styles.featureComparison}>
        <View style={styles.featureColumn}>
          <Text style={styles.featureLabel}>ç„¡æ–™</Text>
          <Text style={styles.featureFree}>{free}</Text>
        </View>
        <View style={styles.featureColumn}>
          <Text style={styles.featureLabel}>Premium</Text>
          <Text style={styles.featurePremium}>{premium}</Text>
        </View>
      </View>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
    backgroundColor: '#FFFFFF',
  },
  header: {
    flexDirection: 'row',
    justifyContent: 'flex-end',
    padding: 16,
  },
  closeButton: {
    width: 40,
    height: 40,
    alignItems: 'center',
    justifyContent: 'center',
  },
  closeText: {
    fontSize: 32,
    color: '#686868',
  },
  titleContainer: {
    alignItems: 'center',
    paddingHorizontal: 24,
    paddingBottom: 32,
  },
  title: {
    fontSize: 32,
    fontWeight: '700',
    color: '#111111',
    marginBottom: 8,
  },
  subtitle: {
    fontSize: 16,
    color: '#686868',
  },
  featuresContainer: {
    paddingHorizontal: 24,
    gap: 16,
  },
  featureItem: {
    backgroundColor: '#F8F8F8',
    borderRadius: 12,
    padding: 16,
  },
  featureItemHighlight: {
    backgroundColor: '#E6F4FE',
    borderWidth: 2,
    borderColor: '#00AA69',
  },
  featureTitle: {
    fontSize: 16,
    fontWeight: '600',
    color: '#111111',
    marginBottom: 12,
  },
  featureComparison: {
    flexDirection: 'row',
    justifyContent: 'space-between',
  },
  featureColumn: {
    flex: 1,
  },
  featureLabel: {
    fontSize: 12,
    color: '#686868',
    marginBottom: 4,
  },
  featureFree: {
    fontSize: 14,
    color: '#111111',
  },
  featurePremium: {
    fontSize: 14,
    color: '#00AA69',
    fontWeight: '600',
  },
  priceContainer: {
    alignItems: 'center',
    paddingVertical: 32,
  },
  priceLabel: {
    fontSize: 14,
    color: '#686868',
    marginBottom: 8,
  },
  price: {
    fontSize: 48,
    fontWeight: '700',
    color: '#111111',
  },
  trial: {
    fontSize: 14,
    color: '#00AA69',
    fontWeight: '600',
    marginTop: 8,
  },
  purchaseButton: {
    backgroundColor: '#111111',
    borderRadius: 12,
    paddingVertical: 16,
    paddingHorizontal: 32,
    marginHorizontal: 24,
    marginBottom: 16,
  },
  purchaseButtonText: {
    color: '#FFFFFF',
    fontSize: 18,
    fontWeight: '600',
    textAlign: 'center',
  },
  disclaimer: {
    fontSize: 12,
    color: '#686868',
    textAlign: 'center',
    paddingHorizontal: 32,
    marginBottom: 24,
  },
  linksContainer: {
    flexDirection: 'row',
    justifyContent: 'center',
    paddingBottom: 32,
  },
  link: {
    fontSize: 12,
    color: '#00AA69',
    textDecorationLine: 'underline',
  },
  linkSeparator: {
    fontSize: 12,
    color: '#686868',
    marginHorizontal: 8,
  },
});
```

**æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-mobile/components/paywall/quota-exceeded-modal.tsx`

```typescript
import { Modal, View, Text, TouchableOpacity, StyleSheet } from 'react-native';
import { router } from 'expo-router';
import { useQuestionCount } from '@/hooks/use-question-count';

interface QuotaExceededModalProps {
  visible: boolean;
  onClose: () => void;
}

export function QuotaExceededModal({ visible, onClose }: QuotaExceededModalProps) {
  const { questionCount } = useQuestionCount();

  return (
    <Modal visible={visible} transparent animationType="fade">
      <View style={styles.overlay}>
        <View style={styles.modal}>
          <Text style={styles.title}>ä»Šæœˆã®è³ªå•å›æ•°ã‚’ä½¿ã„åˆ‡ã‚Šã¾ã—ãŸ</Text>

          <View style={styles.quotaInfo}>
            <Text style={styles.quotaText}>
              {questionCount.monthly} / {questionCount.limit}å›
            </Text>
          </View>

          <Text style={styles.message}>
            æ¥æœˆã¾ã§å¾…ã¤ã‹ã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã¦
            æœˆ1,000å›ã¾ã§è³ªå•ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
          </Text>

          <TouchableOpacity
            style={styles.upgradeButton}
            onPress={() => {
              onClose();
              router.push('/subscription');
            }}
          >
            <Text style={styles.upgradeButtonText}>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚’è¦‹ã‚‹</Text>
          </TouchableOpacity>

          <TouchableOpacity style={styles.closeButton} onPress={onClose}>
            <Text style={styles.closeButtonText}>é–‰ã˜ã‚‹</Text>
          </TouchableOpacity>
        </View>
      </View>
    </Modal>
  );
}

const styles = StyleSheet.create({
  overlay: {
    flex: 1,
    backgroundColor: 'rgba(0, 0, 0, 0.5)',
    justifyContent: 'center',
    alignItems: 'center',
    padding: 24,
  },
  modal: {
    backgroundColor: '#FFFFFF',
    borderRadius: 16,
    padding: 24,
    width: '100%',
    maxWidth: 400,
  },
  title: {
    fontSize: 20,
    fontWeight: '700',
    color: '#111111',
    textAlign: 'center',
    marginBottom: 16,
  },
  quotaInfo: {
    backgroundColor: '#F8F8F8',
    borderRadius: 8,
    padding: 16,
    alignItems: 'center',
    marginBottom: 16,
  },
  quotaText: {
    fontSize: 24,
    fontWeight: '700',
    color: '#111111',
  },
  message: {
    fontSize: 14,
    color: '#686868',
    textAlign: 'center',
    marginBottom: 24,
    lineHeight: 20,
  },
  upgradeButton: {
    backgroundColor: '#111111',
    borderRadius: 12,
    paddingVertical: 14,
    marginBottom: 12,
  },
  upgradeButtonText: {
    color: '#FFFFFF',
    fontSize: 16,
    fontWeight: '600',
    textAlign: 'center',
  },
  closeButton: {
    paddingVertical: 14,
  },
  closeButtonText: {
    color: '#686868',
    fontSize: 16,
    textAlign: 'center',
  },
});
```

**æˆæœç‰©:**
- ãƒšã‚¤ã‚¦ã‚©ãƒ¼ãƒ«UIå®Œæˆ
- ã‚¯ã‚©ãƒ¼ã‚¿è¶…éãƒ¢ãƒ¼ãƒ€ãƒ«å®Œæˆ

---

#### Day 16-17: ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç®¡ç†ç”»é¢

**æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-mobile/app/subscription.tsx`

```typescript
import { useState } from 'react';
import { StyleSheet, View, Text, ScrollView, TouchableOpacity, Alert, Linking } from 'react-native';
import { StatusBar } from 'expo-status-bar';
import { router } from 'expo-router';
import { ThemedView } from '@/components/themed-view';
import { UnifiedHeaderBar } from '@/components/ui/unified-header-bar';
import { useThemeColor } from '@/hooks/use-theme-color';
import { useSubscription } from '@/contexts/subscription-context';
import { PremiumPaywall } from '@/components/paywall/premium-paywall';

export default function SubscriptionScreen() {
  const pageBackground = useThemeColor({}, 'pageBackground');
  const { isPremium, expiryDate, restorePurchases, isLoading } = useSubscription();
  const [showPaywall, setShowPaywall] = useState(false);

  const formatDate = (date: Date | null) => {
    if (!date) return '';
    return new Intl.DateTimeFormat('ja-JP', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
    }).format(date);
  };

  const handleRestore = async () => {
    try {
      await restorePurchases();
      Alert.alert('å¾©å…ƒå®Œäº†', 'è³¼å…¥æƒ…å ±ã‚’å¾©å…ƒã—ã¾ã—ãŸã€‚');
    } catch (error) {
      Alert.alert('å¾©å…ƒå¤±æ•—', 'è³¼å…¥æƒ…å ±ã®å¾©å…ƒã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
    }
  };

  const handleManageSubscription = () => {
    const url =
      Platform.OS === 'ios'
        ? 'https://apps.apple.com/account/subscriptions'
        : 'https://play.google.com/store/account/subscriptions';

    Linking.openURL(url);
  };

  return (
    <ThemedView style={[styles.container, { backgroundColor: pageBackground }]}>
      <StatusBar style="auto" />

      <View style={styles.content}>
        <View style={styles.headerContainer}>
          <UnifiedHeaderBar pageType="other" title="ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³" onBackPress={() => router.back()} />
        </View>

        <ScrollView style={styles.scrollView} showsVerticalScrollIndicator={false}>
          {isPremium ? (
            <View style={styles.premiumContainer}>
              <View style={styles.badgeContainer}>
                <Text style={styles.badge}>Premium</Text>
              </View>

              <Text style={styles.statusTitle}>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡</Text>
              <Text style={styles.statusSubtitle}>ã™ã¹ã¦ã®æ©Ÿèƒ½ã‚’ãŠæ¥½ã—ã¿ã„ãŸã ã‘ã¾ã™</Text>

              {expiryDate && (
                <View style={styles.expiryContainer}>
                  <Text style={styles.expiryLabel}>æœ‰åŠ¹æœŸé™</Text>
                  <Text style={styles.expiryDate}>{formatDate(expiryDate)}</Text>
                </View>
              )}

              <View style={styles.featuresContainer}>
                <FeatureItem icon="âœ“" text="AIè³ªå• æœˆ1,000å›" />
                <FeatureItem icon="âœ“" text="ç¿»è¨³ 50,000æ–‡å­—/å›" />
                <FeatureItem icon="âœ“" text="ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ•ã‚©ãƒ«ãƒ€ç„¡åˆ¶é™" />
                <FeatureItem icon="âœ“" text="å­¦ç¿’è¨€èªç™»éŒ²ç„¡åˆ¶é™" />
                <FeatureItem icon="âœ“" text="è©³ç´°ãªAIå¿œç­”" />
              </View>

              <TouchableOpacity style={styles.manageButton} onPress={handleManageSubscription}>
                <Text style={styles.manageButtonText}>ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†</Text>
              </TouchableOpacity>
            </View>
          ) : (
            <View style={styles.freeContainer}>
              <Text style={styles.freeTitle}>ç„¡æ–™ãƒ—ãƒ©ãƒ³</Text>
              <Text style={styles.freeSubtitle}>åŸºæœ¬æ©Ÿèƒ½ã‚’ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™</Text>

              <View style={styles.limitationsContainer}>
                <Text style={styles.limitationsTitle}>ç¾åœ¨ã®åˆ¶é™</Text>
                <LimitationItem text="AIè³ªå• æœˆ100å›ã¾ã§" />
                <LimitationItem text="ç¿»è¨³ 4,000æ–‡å­—/å›" />
                <LimitationItem text="ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ•ã‚©ãƒ«ãƒ€åˆ©ç”¨ä¸å¯" />
                <LimitationItem text="å­¦ç¿’è¨€èª3è¨€èªã¾ã§" />
                <LimitationItem text="ç°¡æ½”ãªAIå¿œç­”ã®ã¿" />
              </View>

              <TouchableOpacity style={styles.upgradeButton} onPress={() => setShowPaywall(true)}>
                <Text style={styles.upgradeButtonText}>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã«ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰</Text>
              </TouchableOpacity>
            </View>
          )}

          <View style={styles.actionsContainer}>
            <TouchableOpacity style={styles.actionButton} onPress={handleRestore} disabled={isLoading}>
              <Text style={styles.actionButtonText}>è³¼å…¥æƒ…å ±ã‚’å¾©å…ƒ</Text>
            </TouchableOpacity>
          </View>
        </ScrollView>
      </View>

      <PremiumPaywall visible={showPaywall} onClose={() => setShowPaywall(false)} />
    </ThemedView>
  );
}

function FeatureItem({ icon, text }: { icon: string; text: string }) {
  return (
    <View style={styles.featureItem}>
      <Text style={styles.featureIcon}>{icon}</Text>
      <Text style={styles.featureText}>{text}</Text>
    </View>
  );
}

function LimitationItem({ text }: { text: string }) {
  return (
    <View style={styles.limitationItem}>
      <Text style={styles.limitationDot}>â€¢</Text>
      <Text style={styles.limitationText}>{text}</Text>
    </View>
  );
}

const styles = StyleSheet.create({
  container: {
    flex: 1,
  },
  content: {
    flex: 1,
  },
  headerContainer: {
    backgroundColor: '#FFFFFF',
  },
  scrollView: {
    flex: 1,
    padding: 20,
  },
  premiumContainer: {
    backgroundColor: '#FFFFFF',
    borderRadius: 16,
    padding: 24,
    alignItems: 'center',
    marginBottom: 24,
  },
  badgeContainer: {
    marginBottom: 16,
  },
  badge: {
    backgroundColor: '#111111',
    color: '#FFFFFF',
    paddingHorizontal: 16,
    paddingVertical: 6,
    borderRadius: 16,
    fontSize: 12,
    fontWeight: '700',
  },
  statusTitle: {
    fontSize: 24,
    fontWeight: '700',
    color: '#111111',
    marginBottom: 8,
  },
  statusSubtitle: {
    fontSize: 14,
    color: '#686868',
    marginBottom: 24,
  },
  expiryContainer: {
    backgroundColor: '#F8F8F8',
    borderRadius: 12,
    padding: 16,
    width: '100%',
    marginBottom: 24,
  },
  expiryLabel: {
    fontSize: 12,
    color: '#686868',
    marginBottom: 4,
  },
  expiryDate: {
    fontSize: 16,
    fontWeight: '600',
    color: '#111111',
  },
  featuresContainer: {
    width: '100%',
    gap: 12,
    marginBottom: 24,
  },
  featureItem: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 12,
  },
  featureIcon: {
    fontSize: 18,
    color: '#00AA69',
  },
  featureText: {
    fontSize: 14,
    color: '#111111',
  },
  manageButton: {
    backgroundColor: '#F8F8F8',
    borderRadius: 12,
    paddingVertical: 14,
    paddingHorizontal: 24,
    width: '100%',
  },
  manageButtonText: {
    fontSize: 16,
    fontWeight: '600',
    color: '#111111',
    textAlign: 'center',
  },
  freeContainer: {
    backgroundColor: '#FFFFFF',
    borderRadius: 16,
    padding: 24,
    marginBottom: 24,
  },
  freeTitle: {
    fontSize: 24,
    fontWeight: '700',
    color: '#111111',
    marginBottom: 8,
  },
  freeSubtitle: {
    fontSize: 14,
    color: '#686868',
    marginBottom: 24,
  },
  limitationsContainer: {
    backgroundColor: '#F8F8F8',
    borderRadius: 12,
    padding: 16,
    marginBottom: 24,
  },
  limitationsTitle: {
    fontSize: 14,
    fontWeight: '600',
    color: '#111111',
    marginBottom: 12,
  },
  limitationItem: {
    flexDirection: 'row',
    alignItems: 'flex-start',
    gap: 8,
    marginBottom: 8,
  },
  limitationDot: {
    fontSize: 14,
    color: '#686868',
  },
  limitationText: {
    fontSize: 14,
    color: '#686868',
    flex: 1,
  },
  upgradeButton: {
    backgroundColor: '#111111',
    borderRadius: 12,
    paddingVertical: 16,
    paddingHorizontal: 24,
  },
  upgradeButtonText: {
    fontSize: 16,
    fontWeight: '600',
    color: '#FFFFFF',
    textAlign: 'center',
  },
  actionsContainer: {
    gap: 12,
  },
  actionButton: {
    backgroundColor: '#FFFFFF',
    borderRadius: 12,
    paddingVertical: 14,
    paddingHorizontal: 24,
  },
  actionButtonText: {
    fontSize: 14,
    color: '#00AA69',
    textAlign: 'center',
  },
});
```

**æˆæœç‰©:**
- ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç®¡ç†ç”»é¢å®Œæˆ

---

#### Day 18: è¨­å®šç”»é¢çµ±åˆ

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-mobile/app/(tabs)/settings.tsx`

```typescript
import { useSubscription } from '@/contexts/subscription-context';

export default function SettingsScreen() {
  const { isPremium, expiryDate } = useSubscription();

  const formatDate = (date: Date | null) => {
    if (!date) return '';
    return new Intl.DateTimeFormat('ja-JP', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
    }).format(date);
  };

  return (
    <ScrollView>
      {/* ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè¨­å®š */}
      <View style={styles.section}>
        <Text style={styles.sectionTitle}>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ</Text>

        {/* ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ */}
        <TouchableOpacity style={styles.settingItem} onPress={() => router.push('/subscription')}>
          <View style={styles.settingInfo}>
            <View style={styles.labelRow}>
              <Text style={styles.settingLabel}>
                {isPremium ? 'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ä¼šå“¡' : 'ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³'}
              </Text>
              {isPremium && <View style={styles.premiumBadge}>
                <Text style={styles.premiumBadgeText}>Premium</Text>
              </View>}
            </View>
            <Text style={styles.settingDescription}>
              {isPremium
                ? `æœ‰åŠ¹æœŸé™: ${formatDate(expiryDate)}`
                : 'ã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã¦å…¨æ©Ÿèƒ½ã‚’è§£æ”¾'}
            </Text>
          </View>
          <ChevronRightIcon />
        </TouchableOpacity>

        {/* ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« */}
        <TouchableOpacity style={styles.settingItem} onPress={() => router.push('/profile')}>
          <View style={styles.settingInfo}>
            <Text style={styles.settingLabel}>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</Text>
            <Text style={styles.settingDescription}>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±ã‚’ç®¡ç†</Text>
          </View>
          <ChevronRightIcon />
        </TouchableOpacity>
      </View>

      {/* ... æ—¢å­˜ã®è¨­å®šé …ç›® */}
    </ScrollView>
  );
}

const styles = StyleSheet.create({
  // ... æ—¢å­˜ã®ã‚¹ã‚¿ã‚¤ãƒ«
  labelRow: {
    flexDirection: 'row',
    alignItems: 'center',
    gap: 8,
  },
  premiumBadge: {
    backgroundColor: '#111111',
    paddingHorizontal: 8,
    paddingVertical: 2,
    borderRadius: 8,
  },
  premiumBadgeText: {
    color: '#FFFFFF',
    fontSize: 10,
    fontWeight: '700',
  },
});
```

**æˆæœç‰©:**
- è¨­å®šç”»é¢ã«ãƒ—ãƒ¬ãƒŸã‚¢ãƒ è¡¨ç¤ºå®Œäº†

---

### **Week 4: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é€£æºãƒ»ãƒ†ã‚¹ãƒˆ**

#### Day 19-21: Webhookå‡¦ç†

**æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-backend/src/routes/webhook.ts`

```typescript
import { Router, Request, Response } from 'express';
import crypto from 'crypto';
import { supabase } from '../lib/supabase';

const router = Router();

/**
 * RevenueCat Webhookç½²åæ¤œè¨¼
 */
function verifyRevenueCatSignature(body: any, signature: string | undefined): boolean {
  if (!signature) return false;

  const secret = process.env.REVENUECAT_WEBHOOK_SECRET;
  if (!secret) {
    console.warn('[Webhook] REVENUECAT_WEBHOOK_SECRET not set');
    return false;
  }

  const expectedSignature = crypto
    .createHmac('sha256', secret)
    .update(JSON.stringify(body))
    .digest('hex');

  return signature === expectedSignature;
}

/**
 * RevenueCat Webhook ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
 */
router.post('/revenuecat', async (req: Request, res: Response) => {
  console.log('[Webhook] Received RevenueCat event');

  // ç½²åæ¤œè¨¼
  const signature = req.headers['x-revenuecat-signature'] as string;
  const isValid = verifyRevenueCatSignature(req.body, signature);

  if (!isValid) {
    console.error('[Webhook] Invalid signature');
    return res.status(401).json({ error: 'Invalid signature' });
  }

  const { event, app_user_id, product_id, expiration_at_ms, presented_offering_id } = req.body;

  console.log('[Webhook] Event:', {
    type: event?.type,
    userId: app_user_id,
    product: product_id,
  });

  try {
    // ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦å‡¦ç†
    switch (event?.type) {
      case 'INITIAL_PURCHASE':
      case 'RENEWAL':
      case 'UNCANCELLATION':
        await updateSubscription(
          app_user_id,
          'active',
          new Date(expiration_at_ms),
          app_user_id,
          'mobile'
        );
        console.log('[Webhook] Subscription activated for:', app_user_id);
        break;

      case 'CANCELLATION':
        // ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¦ã‚‚æœ‰åŠ¹æœŸé™ã¾ã§ä½¿ãˆã‚‹
        console.log('[Webhook] Subscription cancelled (but still active until expiry):', app_user_id);
        break;

      case 'EXPIRATION':
      case 'BILLING_ISSUE':
        await updateSubscription(app_user_id, 'inactive', null, app_user_id, 'mobile');
        console.log('[Webhook] Subscription expired for:', app_user_id);
        break;

      case 'PRODUCT_CHANGE':
        await updateSubscription(
          app_user_id,
          'active',
          new Date(expiration_at_ms),
          app_user_id,
          'mobile'
        );
        console.log('[Webhook] Subscription product changed for:', app_user_id);
        break;

      default:
        console.log('[Webhook] Unhandled event type:', event?.type);
    }

    res.json({ received: true });
  } catch (error) {
    console.error('[Webhook] Error processing event:', error);
    res.status(500).json({ error: 'Failed to process webhook' });
  }
});

/**
 * ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³çŠ¶æ…‹ã‚’æ›´æ–°
 */
async function updateSubscription(
  userId: string,
  status: string,
  expiresAt: Date | null,
  customerId: string,
  platform: string
): Promise<void> {
  // Supabaseã®update_subscription_statusé–¢æ•°ã‚’å‘¼ã³å‡ºã—
  const { error } = await supabase.rpc('update_subscription_status', {
    user_id: userId,
    status,
    expires_at: expiresAt?.toISOString() || null,
    customer_id: customerId,
    platform,
  });

  if (error) {
    console.error('[Webhook] Failed to update subscription:', error);
    throw error;
  }

  console.log('[Webhook] Subscription updated in database:', {
    userId,
    status,
    expiresAt: expiresAt?.toISOString(),
  });
}

export default router;
```

**å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«:**
`lingooo-backend/src/index.ts`

```typescript
import webhookRouter from './routes/webhook';

// Webhookï¼ˆèªè¨¼ä¸è¦ï¼‰
app.use('/api/webhook', webhookRouter);
```

**ç’°å¢ƒå¤‰æ•°è¿½åŠ :**
`lingooo-backend/.env`

```
REVENUECAT_WEBHOOK_SECRET=your_webhook_secret_here
```

**æˆæœç‰©:**
- RevenueCat Webhookå‡¦ç†å®Œäº†
- Supabaseè‡ªå‹•åŒæœŸå®Œäº†

---

#### Day 22-24: ãƒ†ã‚¹ãƒˆ

**ãƒ†ã‚¹ãƒˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ:**

**1. è³¼å…¥ãƒ•ãƒ­ãƒ¼**
- [ ] iOS ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹è³¼å…¥
- [ ] Android Test è³¼å…¥
- [ ] ãƒˆãƒ©ã‚¤ã‚¢ãƒ«æœŸé–“ã®å‹•ä½œï¼ˆ7æ—¥é–“ç„¡æ–™ï¼‰
- [ ] è³¼å…¥å¾Œã™ãã«ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½ãŒä½¿ãˆã‚‹
- [ ] è³¼å…¥å¤±æ•—æ™‚ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

**2. åˆ¶é™æ©Ÿèƒ½ï¼ˆç„¡æ–™ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰**
- [ ] AIè³ªå•ãŒæœˆ100å›ã§åˆ¶é™ã•ã‚Œã‚‹
- [ ] ç¿»è¨³ãŒ4,000æ–‡å­—ã§åˆ¶é™ã•ã‚Œã‚‹
- [ ] å­¦ç¿’è¨€èªãŒ3è¨€èªã§åˆ¶é™ã•ã‚Œã‚‹
- [ ] ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ•ã‚©ãƒ«ãƒ€ãŒä½œæˆã§ããªã„
- [ ] AIè©³ç´°åº¦ãŒã€Œè©³ç´°ã€ã«åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œãªã„
- [ ] åˆ¶é™åˆ°é”æ™‚ã«ãƒšã‚¤ã‚¦ã‚©ãƒ¼ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã‚‹

**3. åˆ¶é™è§£é™¤ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰**
- [ ] AIè³ªå•ãŒæœˆ1,000å›ä½¿ãˆã‚‹
- [ ] ç¿»è¨³ãŒ50,000æ–‡å­—ä½¿ãˆã‚‹
- [ ] å­¦ç¿’è¨€èªãŒç„¡åˆ¶é™ã«ç™»éŒ²ã§ãã‚‹
- [ ] ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ•ã‚©ãƒ«ãƒ€ãŒä½œæˆã§ãã‚‹
- [ ] AIè©³ç´°åº¦ãŒã€Œè©³ç´°ã€ã«åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹

**4. ãƒªã‚¹ãƒˆã‚¢æ©Ÿèƒ½**
- [ ] æ©Ÿç¨®å¤‰æ›´å¾Œã«ãƒªã‚¹ãƒˆã‚¢ã§ãã‚‹
- [ ] ã‚¢ãƒ—ãƒªå‰Šé™¤ãƒ»å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã«ãƒªã‚¹ãƒˆã‚¢ã§ãã‚‹
- [ ] ãƒªã‚¹ãƒˆã‚¢ãƒœã‚¿ãƒ³ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹

**5. Webhook**
- [ ] è³¼å…¥ã‚¤ãƒ™ãƒ³ãƒˆã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒæ›´æ–°ã•ã‚Œã‚‹
- [ ] æ›´æ–°ã‚¤ãƒ™ãƒ³ãƒˆã§æœ‰åŠ¹æœŸé™ãŒå»¶é•·ã•ã‚Œã‚‹
- [ ] ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆå¾Œã‚‚æœŸé™ã¾ã§ä½¿ãˆã‚‹
- [ ] æœ‰åŠ¹æœŸé™åˆ‡ã‚Œã§ç„¡æ–™ãƒ—ãƒ©ãƒ³ã«æˆ»ã‚‹

**6. UI/UX**
- [ ] ãƒšã‚¤ã‚¦ã‚©ãƒ¼ãƒ«ãŒé©åˆ‡ã«è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] è¨­å®šç”»é¢ã«ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç®¡ç†ç”»é¢ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- [ ] ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ãŒé©åˆ‡ã«è¡¨ç¤ºã•ã‚Œã‚‹

**æˆæœç‰©:**
- å…¨ãƒ†ã‚¹ãƒˆé …ç›®ã‚¯ãƒªã‚¢
- ãƒã‚°ä¿®æ­£å®Œäº†

---

#### Day 25-28: ãƒªãƒªãƒ¼ã‚¹æº–å‚™

**App Store å¯¾å¿œ:**

1. **ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ›´æ–°**
   - ãƒ—ãƒ¬ãƒŸã‚¢ãƒ æ©Ÿèƒ½ã®èª¬æ˜ç”»åƒè¿½åŠ 
   - ãƒšã‚¤ã‚¦ã‚©ãƒ¼ãƒ«ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ
   - æ©Ÿèƒ½æ¯”è¼ƒè¡¨ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ

2. **Appèª¬æ˜æ–‡æ›´æ–°**
   ```
   ã€ç„¡æ–™ç‰ˆã€‘
   - AIè³ªå• æœˆ100å›
   - ç¿»è¨³ 4,000æ–‡å­—/å›
   - åŸºæœ¬çš„ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯æ©Ÿèƒ½

   ã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ç‰ˆï¼ˆæœˆé¡500å††ï¼‰ã€‘
   - AIè³ªå• æœˆ1,000å›
   - ç¿»è¨³ 50,000æ–‡å­—/å›
   - ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ•ã‚©ãƒ«ãƒ€ç„¡åˆ¶é™
   - å­¦ç¿’è¨€èªç™»éŒ²ç„¡åˆ¶é™
   - è©³ç´°ãªAIå¿œç­”
   - 7æ—¥é–“ç„¡æ–™ãƒˆãƒ©ã‚¤ã‚¢ãƒ«
   ```

3. **ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼æ›´æ–°**
   - ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æƒ…å ±ã®å–ã‚Šæ‰±ã„
   - RevenueCaté€£æºã«ã¤ã„ã¦
   - è‡ªå‹•æ›´æ–°ã«é–¢ã™ã‚‹è¨˜è¼‰

4. **åˆ©ç”¨è¦ç´„æ›´æ–°**
   - ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³è¦ç´„
   - è¿”é‡‘ãƒãƒªã‚·ãƒ¼
   - ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒãƒªã‚·ãƒ¼

5. **IAPå¯©æŸ»æƒ…å ±**
   - ãƒ†ã‚¹ãƒˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆæƒ…å ±
   - ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹è³¼å…¥æ‰‹é †
   - ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãƒ»å‹•ç”»

**ãƒªãƒªãƒ¼ã‚¹æ‰‹é †:**

1. EAS Buildï¼ˆproductionï¼‰
   ```bash
   eas build --platform ios --profile production
   eas build --platform android --profile production
   ```

2. TestFlighté…ä¿¡
   ```bash
   eas submit --platform ios --profile production
   ```

3. ãƒ™ãƒ¼ã‚¿ãƒ†ã‚¹ã‚¿ãƒ¼å‹Ÿé›†ï¼ˆ10ã€œ20åï¼‰
   - ã‚µãƒ–ã‚¹ã‚¯è³¼å…¥ãƒ†ã‚¹ãƒˆ
   - æ©Ÿèƒ½åˆ¶é™ãƒ†ã‚¹ãƒˆ
   - UI/UXãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

4. ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åé›†ãƒ»æ”¹å–„
   - ãƒã‚°ä¿®æ­£
   - UIæ”¹å–„
   - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

5. App Store å¯©æŸ»æå‡º
   - å¯©æŸ»ãƒãƒ¼ãƒˆè¨˜è¼‰
   - ãƒ‡ãƒ¢å‹•ç”»æ·»ä»˜
   - IAPå¯©æŸ»æƒ…å ±æå‡º

**æˆæœç‰©:**
- App Store å¯©æŸ»æå‡ºå®Œäº†
- Google Play Console ç”³è«‹å®Œäº†

---

## ğŸ¯ æŠ€è¡“é¸å®š

### RevenueCat æ¡ç”¨ç†ç”±

**é¸å®šç†ç”±:**
1. âœ… **Expoå®Œå…¨å¯¾å¿œ** - SDKçµ±åˆãŒç°¡å˜
2. âœ… **ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ** - iOS/Androidä¸¡å¯¾å¿œ
3. âœ… **ãƒ¬ã‚·ãƒ¼ãƒˆæ¤œè¨¼è‡ªå‹•åŒ–** - ã‚µãƒ¼ãƒãƒ¼å®Ÿè£…ä¸è¦
4. âœ… **ç„¡æ–™æ ** - æœˆ$2,500å£²ä¸Šã¾ã§ç„¡æ–™ï¼ˆ100äººèª²é‡‘ã¾ã§ç„¡æ–™ï¼‰
5. âœ… **ãƒªã‚¹ãƒˆã‚¢æ©Ÿèƒ½** - æ©Ÿç¨®å¤‰æ›´æ™‚ã®å¾©å…ƒãŒç°¡å˜
6. âœ… **Webhookå¯¾å¿œ** - ã‚µãƒ–ã‚¹ã‚¯çŠ¶æ…‹ã®è‡ªå‹•åŒæœŸ
7. âœ… **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå……å®Ÿ** - å®Ÿè£…ä¾‹è±Šå¯Œ

**ä»£æ›¿æ¡ˆã¨ã®æ¯”è¼ƒ:**

| é …ç›® | RevenueCat | Stripe | ç›´æ¥IAP |
|------|-----------|--------|---------|
| ãƒ¢ãƒã‚¤ãƒ«IAPå¯¾å¿œ | â— | â–³ | â— |
| å®Ÿè£…é›£æ˜“åº¦ | æ˜“ | é›£ | ä¸­ |
| ãƒ¬ã‚·ãƒ¼ãƒˆæ¤œè¨¼ | è‡ªå‹• | æ‰‹å‹• | æ‰‹å‹• |
| ç„¡æ–™æ  | $2,500/æœˆ | ãªã— | - |
| Webhook | â— | â— | â–³ |

**çµè«–: RevenueCatãŒæœ€é©**

---

### Gemini Flash ç¶™ç¶šã®åˆ¤æ–­

**ã‚³ã‚¹ãƒˆæ¯”è¼ƒ:**

| ãƒ¢ãƒ‡ãƒ« | å…¥åŠ›å˜ä¾¡ | å‡ºåŠ›å˜ä¾¡ | 1ãƒªã‚¯ã‚¨ã‚¹ãƒˆ |
|--------|---------|---------|-----------|
| **Flash** | $0.075/M | $0.30/M | **0.04å††** |
| Pro | $1.25/M | $5.00/M | 0.68å†† |

**ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚³ã‚¹ãƒˆè©¦ç®—:**

```
æœˆ1,000å›ä½¿ç”¨æ™‚:

Flash: 1,000å› Ã— 0.04å†† = 40å††/æœˆ
  â†’ å£²ä¸Š500å†† - ã‚³ã‚¹ãƒˆ40å†† = åˆ©ç›Š460å††ï¼ˆåˆ©ç›Šç‡92%ï¼‰

Pro: 1,000å› Ã— 0.68å†† = 680å††/æœˆ
  â†’ å£²ä¸Š500å†† - ã‚³ã‚¹ãƒˆ680å†† = èµ¤å­—180å††
```

**Flashç¶™ç¶šã®ç†ç”±:**

1. âœ… **ã‚³ã‚¹ãƒˆåŠ¹ç‡ãŒåœ§å€’çš„** - åˆ©ç›Šç‡92%ç¶­æŒ
2. âœ… **å“è³ªãŒååˆ†** - è¾æ›¸ãƒ»ç¿»è¨³ç”¨é€”ã§é«˜å“è³ª
3. âœ… **å·®åˆ¥åŒ–ãŒååˆ†** - å›æ•°ãƒ»æ©Ÿèƒ½åˆ¶é™ã§ä¾¡å€¤æä¾›
4. âœ… **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«** - ãƒ¦ãƒ¼ã‚¶ãƒ¼å¢—åŠ ã«å¯¾å¿œå¯èƒ½

**ä»£æ›¿ã®å·®åˆ¥åŒ–æˆ¦ç•¥:**

```typescript
// ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é™å®šã®è©³ç´°ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
const premiumPrompt = `è‹±å˜èª"${word}"ã«ã¤ã„ã¦ä»¥ä¸‹ã‚’å«ã‚ã¦è©³ã—ãèª¬æ˜ï¼š
1. èªæºã¨æ­´å²
2. ãƒ‹ãƒ¥ã‚¢ãƒ³ã‚¹ã¨é¡ç¾©èªã¨ã®é•ã„
3. æ–‡åŒ–çš„èƒŒæ™¯
4. ãƒ•ã‚©ãƒ¼ãƒãƒ«/ã‚«ã‚¸ãƒ¥ã‚¢ãƒ«ãªä½¿ã„åˆ†ã‘
5. 5ã¤ä»¥ä¸Šã®å®Ÿç”¨ä¾‹æ–‡
6. ã‚ˆãã‚ã‚‹é–“é•ã„`;
```

**çµè«–: Flashã§ååˆ†ï¼Proã¯ä¸æ¡ç”¨**

---

## ğŸ’° ã‚³ã‚¹ãƒˆãƒ»åç›Šåˆ†æ

### å›ºå®šè²»ï¼ˆæœˆé¡ï¼‰

- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ï¼ˆRenderç­‰ï¼‰: 7,000å††
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆSupabase Proï¼‰: 3,500å††
- Redisï¼ˆUpstashç­‰ï¼‰: 1,500å††
- é–‹ç™ºãƒ»ä¿å®ˆè²»ç”¨: 18,000å††
- **åˆè¨ˆå›ºå®šè²»: 30,000å††/æœˆ**

### å¤‰å‹•è²»ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚ãŸã‚Šï¼‰

- Gemini APIï¼ˆæœˆ1,000å›ä½¿ç”¨ï¼‰: 40å††/æœˆ
- ãã®ä»–é€šä¿¡è²»: 10å††/æœˆ
- **åˆè¨ˆå¤‰å‹•è²»: 50å††/æœˆ/ãƒ¦ãƒ¼ã‚¶ãƒ¼**

### å£²ä¸Š

- ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ—ãƒ©ãƒ³: 500å††/æœˆ/ãƒ¦ãƒ¼ã‚¶ãƒ¼
- **ç²—åˆ©: 450å††/æœˆ/ãƒ¦ãƒ¼ã‚¶ãƒ¼**ï¼ˆ500å†† - 50å††ï¼‰

### æç›Šåˆ†å²ç‚¹

```
å›ºå®šè²» Ã· ç²—åˆ© = å¿…è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°
30,000å†† Ã· 450å†† = 67äºº
```

**æç›Šåˆ†å²ç‚¹: 67äººã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼**

### ç›®æ¨™åˆ©ç›Šåˆ¥ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°

| ç›®æ¨™åˆ©ç›Š | å¿…è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•° | æœˆé–“å£²ä¸Š | æœˆé–“åˆ©ç›Š | åˆ©ç›Šç‡ |
|---------|--------------|---------|---------|--------|
| é»’å­—åŒ– | **67äºº** | 33,500å†† | 150å†† | 0.4% |
| æœˆ1ä¸‡åˆ©ç›Š | 89äºº | 44,500å†† | 10,050å†† | 22.6% |
| æœˆ5ä¸‡åˆ©ç›Š | 178äºº | 89,000å†† | 50,100å†† | 56.3% |
| **æœˆ10ä¸‡åˆ©ç›Š** | **289äºº** | **144,500å††** | **100,050å††** | **69.2%** |
| æœˆ20ä¸‡åˆ©ç›Š | 511äºº | 255,500å†† | 200,000å†† | 78.3% |
| **æœˆ50ä¸‡åˆ©ç›Š** | **1,178äºº** | **589,000å††** | **500,000å††** | **84.9%** |

### ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°åˆ¥ã®æç›Šè¡¨

| ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•° | æœˆé–“å£²ä¸Š | å¤‰å‹•è²» | å›ºå®šè²» | æœˆé–“åˆ©ç›Š | åˆ©ç›Šç‡ |
|-----------|---------|--------|--------|---------|--------|
| 50äºº | 25,000å†† | 2,500å†† | 30,000å†† | **-7,500å††** âŒ | -30.0% |
| 67äºº | 33,500å†† | 3,350å†† | 30,000å†† | **+150å††** âœ… | 0.4% |
| **100äºº** | **50,000å††** | **5,000å††** | **30,000å††** | **+15,000å††** âœ… | **30.0%** |
| 200äºº | 100,000å†† | 10,000å†† | 30,000å†† | **+60,000å††** âœ… | 60.0% |
| 289äºº | 144,500å†† | 14,450å†† | 30,000å†† | **+100,050å††** âœ… | 69.2% |
| **500äºº** | **250,000å††** | **25,000å††** | **30,000å††** | **+195,000å††** âœ… | **78.0%** |
| 1,000äºº | 500,000å†† | 50,000å†† | 30,000å†† | **+420,000å††** âœ… | 84.0% |

### ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³

**Phase 1: ç”Ÿãæ®‹ã‚‹ï¼ˆæç›Šåˆ†å²ï¼‰**
- ç›®æ¨™: 67äººã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼
- æœŸé–“: 3ãƒ¶æœˆä»¥å†…
- åˆ©ç›Š: 0å††ï¼ˆåæ”¯ãƒˆãƒ³ãƒˆãƒ³ï¼‰

**Phase 2: å®‰å®šã™ã‚‹ï¼ˆ100äººï¼‰**
- ç›®æ¨™: 100äººã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼
- æœŸé–“: 6ãƒ¶æœˆä»¥å†…
- åˆ©ç›Š: æœˆ15,000å††

**Phase 3: æˆé•·ã™ã‚‹ï¼ˆ500äººï¼‰**
- ç›®æ¨™: 500äººã®ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼
- æœŸé–“: 18ãƒ¶æœˆä»¥å†…
- åˆ©ç›Š: æœˆ195,000å††

---

## ğŸ“ æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒªï¼ˆ11ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

```
lingooo-mobile/
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ subscription-context.tsx           [NEW] ã‚µãƒ–ã‚¹ã‚¯çŠ¶æ…‹ç®¡ç†
â”œâ”€â”€ components/
â”‚   â””â”€â”€ paywall/
â”‚       â”œâ”€â”€ premium-paywall.tsx            [NEW] ãƒšã‚¤ã‚¦ã‚©ãƒ¼ãƒ«UI
â”‚       â””â”€â”€ quota-exceeded-modal.tsx       [NEW] ã‚¯ã‚©ãƒ¼ã‚¿è¶…éãƒ¢ãƒ¼ãƒ€ãƒ«
â”œâ”€â”€ app/
â”‚   â””â”€â”€ subscription.tsx                   [NEW] ã‚µãƒ–ã‚¹ã‚¯ç®¡ç†ç”»é¢
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ use-premium-check.ts               [NEW] ãƒ—ãƒ¬ãƒŸã‚¢ãƒ åˆ¤å®šHook
â”œâ”€â”€ supabase/migrations/
â”‚   â””â”€â”€ 002_add_subscription_fields.sql    [NEW] DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
â”œâ”€â”€ types/
â”‚   â””â”€â”€ subscription.ts                    [NEW] ã‚µãƒ–ã‚¹ã‚¯å‹å®šç¾©
â””â”€â”€ utils/
    â””â”€â”€ paywall-manager.ts                 [NEW] ãƒšã‚¤ã‚¦ã‚©ãƒ¼ãƒ«ç®¡ç†
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆ3ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

```
lingooo-backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ webhook.ts                     [NEW] RevenueCat Webhook
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â””â”€â”€ premium-check.ts               [NEW] ãƒ—ãƒ¬ãƒŸã‚¢ãƒ åˆ¤å®š
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ revenuecat-verify.ts           [NEW] Webhookç½²åæ¤œè¨¼
```

### å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«

**ãƒ¢ãƒã‚¤ãƒ«ã‚¢ãƒ—ãƒª:**
- `app/_layout.tsx` - SubscriptionProviderè¿½åŠ 
- `app/(tabs)/settings.tsx` - ãƒ—ãƒ¬ãƒŸã‚¢ãƒ è¡¨ç¤ºè¿½åŠ 
- `app/(tabs)/bookmarks.tsx` - ãƒ•ã‚©ãƒ«ãƒ€åˆ¶é™è¿½åŠ 
- `app/(tabs)/translate.tsx` - æ–‡å­—æ•°åˆ¶é™è¿½åŠ 
- `contexts/learning-languages-context.tsx` - è¨€èªæ•°åˆ¶é™è¿½åŠ 
- `constants/validation.ts` - æ–‡å­—æ•°åˆ¶é™å®šæ•°è¿½åŠ 

**ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰:**
- `src/index.ts` - Webhook ãƒ«ãƒ¼ãƒˆè¿½åŠ 
- `src/routes/translate.ts` - ãƒ—ãƒ¬ãƒŸã‚¢ãƒ åˆ¤å®šè¿½åŠ 
- `src/middleware/quota.ts` - ãƒ—ãƒ¬ãƒŸã‚¢ãƒ é™¤å¤–ãƒ­ã‚¸ãƒƒã‚¯

---

## âœ… å®Œæˆãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### æ©Ÿèƒ½å®Ÿè£…

- [ ] RevenueCat SDKçµ±åˆå®Œäº†
- [ ] ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³è³¼å…¥ãƒ•ãƒ­ãƒ¼å‹•ä½œ
- [ ] 7æ—¥é–“ç„¡æ–™ãƒˆãƒ©ã‚¤ã‚¢ãƒ«è¨­å®šå®Œäº†
- [ ] AIè³ªå•å›æ•°åˆ¶é™ï¼ˆç„¡æ–™100å›/æœˆã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ 1,000å›/æœˆï¼‰
- [ ] ç¿»è¨³æ–‡å­—æ•°åˆ¶é™ï¼ˆç„¡æ–™4,000æ–‡å­—ã€ãƒ—ãƒ¬ãƒŸã‚¢ãƒ 50,000æ–‡å­—ï¼‰
- [ ] å­¦ç¿’è¨€èª3è¨€èªåˆ¶é™ï¼ˆç„¡æ–™ã®ã¿ï¼‰
- [ ] ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ãƒ•ã‚©ãƒ«ãƒ€åˆ¶é™ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã®ã¿ï¼‰
- [ ] AIè©³ç´°åº¦åˆ¶é™ï¼ˆãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã®ã¿ï¼‰
- [ ] ãƒšã‚¤ã‚¦ã‚©ãƒ¼ãƒ«UIå®Ÿè£…
- [ ] ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ç®¡ç†ç”»é¢å®Ÿè£…
- [ ] è¨­å®šç”»é¢ã«ãƒ—ãƒ¬ãƒŸã‚¢ãƒ è¡¨ç¤º

### ãƒ†ã‚¹ãƒˆ

- [ ] iOS ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹è³¼å…¥æˆåŠŸ
- [ ] Android Test è³¼å…¥æˆåŠŸ
- [ ] ãƒˆãƒ©ã‚¤ã‚¢ãƒ«æœŸé–“æ­£å¸¸å‹•ä½œ
- [ ] è³¼å…¥å¾Œã™ãã«æ©Ÿèƒ½è§£æ”¾
- [ ] ãƒªã‚¹ãƒˆã‚¢æ©Ÿèƒ½å‹•ä½œç¢ºèª
- [ ] ç„¡æ–™ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åˆ¶é™ç¢ºèª
- [ ] ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è§£æ”¾ç¢ºèª
- [ ] Webhookå‹•ä½œç¢ºèª
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åŒæœŸç¢ºèª

### ãƒªãƒªãƒ¼ã‚¹æº–å‚™

- [ ] App Store ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ›´æ–°
- [ ] App èª¬æ˜æ–‡æ›´æ–°
- [ ] ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼æ›´æ–°
- [ ] åˆ©ç”¨è¦ç´„æ›´æ–°
- [ ] IAPå¯©æŸ»æƒ…å ±æº–å‚™
- [ ] TestFlight ãƒ™ãƒ¼ã‚¿ãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] ãƒã‚°ä¿®æ­£å®Œäº†
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–å®Œäº†
- [ ] App Store å¯©æŸ»æå‡º
- [ ] Google Play Console ç”³è«‹

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **Week 1 é–‹å§‹**: RevenueCat ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ
2. **ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³è¨­å®š**: 3ãƒ¶æœˆã§67äººã€6ãƒ¶æœˆã§100äºº
3. **KPIè¿½è·¡é–‹å§‹**: ç„¡æ–™â†’æœ‰æ–™ã‚³ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç‡ã€ãƒãƒ£ãƒ¼ãƒ³ç‡
4. **ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°æº–å‚™**: ASOå¯¾ç­–ã€ãƒ—ãƒ¬ã‚¹ãƒªãƒªãƒ¼ã‚¹

---

**æœ€çµ‚æ›´æ–°**: 2025-01-18
**æ¬¡å›ãƒ¬ãƒ“ãƒ¥ãƒ¼**: å®Ÿè£…é–‹å§‹æ™‚
